<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Document</title>
</head>

<body>

  <script>
    // 기본 작업

    // body변수에 문서안 body를 할당
    const body = document.body
    // body의 scroll삭제
    body.style.overflow = "hidden"
    // 문구를 집어넣을 root생성
    const root = document.createElement("div")
    // body에 root를 자식요소로 추가
    body.appendChild(root);
    // 문장 객체
    const item = {
      click: "click",
      en: "if all you have a hammer, everything looks like a nail",
      ko: "가진것이 망치뿐이면, 모든 것이 못으로 보인다.",
    }
    // 바디에 flex center하기 위해 높이 지정
    body.style.height = "100vh"
    // 바디에 flex center 설정
    displayFlexCenter(body)
    // 기본 root값 설정

    root.innerHTML = item.click
    root.style.width = "100px"
    root.style.height = "100px"
    root.style.backgroundColor = "#333"
    root.style.color = "#fff"
    root.style.borderRadius = "50px"
    displayFlexCenter(root);
    // count를 0으로 설정하고 그 숫자가 변할 때마다 root변경
    let count = 0;
    // root에 이벤트 등록
    root.addEventListener("click", () => {
      // count를 3으로 나누고 나머지 값에 따라 화면 변경
      if (count % 3 === 0) {
        root.innerHTML = item.en
        root.style.width = "100vw"
        root.style.height = "100vh"
        root.style.backgroundColor = "#fff"
        root.style.color = "#333"
        count++
      }
      else if (count % 3 === 1) {
        root.innerHTML = item.ko
        root.style.width = "100vw"
        root.style.height = "100vh"
        root.style.backgroundColor = "#fff"
        root.style.color = "#333"
        count++
      }
      else {
        root.innerHTML = item.click
        root.style.width = "100px"
        root.style.height = "100px"
        root.style.backgroundColor = "#333"
        root.style.color = "#fff"
        root.style.borderRadius = "50px"
        count++
      }
    })
    // display flex center 함수
    function displayFlexCenter(tag) {
      tag.style.display = "flex"
      tag.style.justifyContent = "center"
      tag.style.alignItems = "center"
    }

    // 추가 작업
    // 게임플레이 방법
    // click버튼이 없는 페이지에서 enter키를 누르면 게임이 시작된다.
    // wsad로 플레이어를 이동시켜 오렌지색깔 폭발속에서 핑크색 벙커에 숨어서 포인트를 얻는 게임이다.
    // 포인트가 3점 이상이 될 경우 게임이 종료된다.

    // player의 이동속도
    let speed = 10;
    // 왼쪽과 오른쪽에 해당하는 translate값
    let leftRight = 0;
    // 위와 아래에 해당하는 translate값
    let upDown = 0;
    // 벙커의 x축 위치를 모은 배열
    let bungkerPositionX = [];
    // 벙커의 y축 위치를 모은 배열
    let bungkerPositionY = [];
    // 폭탄의 시간초를 세기위한 count
    let boomCount = 0;
    // 폭탄을 몇번 피했나 확인하기 위한 점수 count
    let point = 0;
    // 폭탄과 관련된 setInterval을 컨트롤 하기 위한 변수
    let boomManager;
    // 벙커와 관련된 setInterval을 컨트롤 하기 위한 변수
    let bungkerManager;
    // 플레이어 변수
    let player;
    // 윈도우에 키다운 이벤트 등록 
    window.addEventListener("keydown", (e) => {
      // 조건을 13번키, 엔터를 눌렀을 경우와 click버튼이 있을 때를 제외한 조건으로 설정
      if (e.keyCode === 13 && !(count % 3 === 0)) {
        // 게임이 시작되었을 때 root.innerHTML을 Game Start로 변경
        root.innerHTML = "Game Start!"
        // player 생성
        player = document.createElement("div");
        // 바디안에 플레이어 넣기
        body.appendChild(player);
        // 플레이어 위치, 크기, 색상 등 설정
        player.style.width = "20px";
        player.style.height = "20px";
        player.style.backgroundColor = "cadetblue"
        player.style.borderRadius = "5px"
        player.style.position = "absolute"
        player.style.left = 0;
        player.style.top = 0;
        // 0.4초마다 벙커생성
        bungkerManager = setInterval(() => {
          bungkerCreate(boomCount)
        }, 400)
        // 1초마다 폭탄의 시간을 1초 증가 폭탄의 시간이 6초 지나면 배경색을 오렌지 색으로 변경
        boomManager = setInterval(() => {
          boomCount++
          if (boomCount > 5) {
            root.style.backgroundColor = "orange"
            // 그후 1초뒤 폭탄시간 0으로 초기화
            setTimeout(() => {
              boomCount = 0;
            }, 1000)
          }
          // 폭탄 카운트가 6미만일 경우 배경을 하얀색으로 설정
          else {
            root.style.backgroundColor = "#fff"
          }
        }, 1000)

        // 플레이어 이동 keypress 이벤트
        window.addEventListener("keypress", (e) => {

          // left 97 right 100 up 119 down 115 space 32 방향키 설정키값

          // left 움직임
          if (e.keyCode === 97) {
            leftRight -= speed
          }
          // right 움직임
          else if (e.keyCode === 100) {
            leftRight += speed
          }
          // up 움직임
          else if (e.keyCode === 119) {
            upDown -= speed
          }
          // down 움직임
          else if (e.keyCode === 115) {
            upDown += speed
          }
          //  transform을 건드려 움직여준다.
          player.style.transform = `translate(${leftRight}px, ${upDown}px)`
        })
      }
    })
    // 벙커 생성 함수
    function bungkerCreate(boom) {
      // 벙커의 랜덤한 위치를 만드는 배열
      let randomPosition = [Math.floor((Math.random() * body.scrollWidth) / 10) * 10, Math.floor((Math.random() * body.scrollHeight) / 10) * 10]
      // 벙커 생성
      let bungker = document.createElement("nav");
      // 바디에 벙커 넣기
      body.appendChild(bungker);
      // 벙커의 스타일 설정
      bungker.style.width = "20px";
      bungker.style.height = "20px";
      bungker.style.backgroundColor = "pink"
      bungker.style.borderRadius = "5px"
      bungker.style.position = "absolute"
      // 벙커의 랜덤한 위치 설정
      bungker.style.left = `${randomPosition[0]}px`;
      bungker.style.top = `${randomPosition[1]}px`;
      // 벙커의 x축위치, y축위치를 배열에 넣어서 해당 벙커를 지우게 한다.
      bungkerPositionX.push(randomPosition[0]);
      bungkerPositionY.push(randomPosition[1]);
      // 벙커를 지우는 setInterval
      let remove = setInterval(() => {
        bungkerPositionX.shift();
        bungkerPositionY.shift();
        bungker.remove();
        clearInterval(remove);
      }, 4000)

      // 게임을 클리어하기 위한 조건의 일부를 판별하기 위한 for문
      for (let i = 0; i < bungkerPositionX.length; i++) {
        // 조건은 벙커의 x축과 y축의 위치에 플레이어가 겹쳐져야 하고, 폭탄이 터졌을 때만 포인트가 쌓인다.
        if (leftRight === bungkerPositionX[i] && upDown === bungkerPositionY[i] && boom > 5) {
          point++
          // 그 포인트가 3이 되었을 때 게임이 클리어 된다.
          if (point > 2) {
            // root에 game clear 문구 출력
            root.innerHTML = "Game Clear!"
            // interval 정지
            clearInterval(boomManager)
            clearInterval(bungkerManager)
            // player 삭제
            player.remove();
            root.style.backgroundColor = "#fff"
          }
        }
      }
    }

  </script>
</body>

</html>